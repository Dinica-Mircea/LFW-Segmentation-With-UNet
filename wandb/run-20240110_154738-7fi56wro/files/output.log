
Using device:  cuda
Epoch 1/50:   0%|          | 0/2049 [00:00<?, ?img/s]
torch.Size([100, 3, 200, 200])
torch.Size([100, 64, 196, 196])
torch.Size([100, 64, 98, 98])
torch.Size([100, 128, 94, 94])
torch.Size([100, 128, 47, 47])
torch.Size([100, 256, 43, 43])
torch.Size([100, 256, 21, 21])
torch.Size([100, 512, 17, 17])
torch.Size([100, 512, 8, 8])
tensor([[[[-2.5330e-02, -9.3445e-02,  3.6572e-01,  ..., -2.1484e-01,
           -2.0044e-01, -2.1118e-01],
          [-7.1826e-01, -4.6118e-01, -5.9912e-01,  ..., -2.2998e-01,
           -2.3364e-01, -2.3926e-01],
          [-5.2051e-01, -4.4312e-01, -2.9492e-01,  ..., -2.3486e-01,
           -2.4536e-01, -2.3096e-01],
          ...,
          [-4.5117e-01, -3.8208e-01,  1.8994e-01,  ..., -3.5962e-01,
           -1.8115e-01, -2.1240e-02],
          [-4.3115e-01, -4.1138e-01,  3.1226e-01,  ..., -4.1943e-01,
           -3.3862e-01, -1.5845e-01],
          [-4.2456e-01, -3.7988e-01,  2.0752e-01,  ..., -3.5962e-01,
           -3.8770e-01, -1.9702e-01]],
         [[-5.9082e-01, -6.0547e-01, -6.8176e-02,  ..., -3.5278e-01,
           -3.3765e-01, -3.5107e-01],
          [-7.0752e-01, -4.6338e-01, -6.4209e-01,  ..., -3.6279e-01,
           -3.5083e-01, -3.5254e-01],
          [-6.9824e-01, -5.8105e-01, -4.5020e-01,  ..., -3.2812e-01,
           -3.3472e-01, -3.3130e-01],
          ...,
          [-5.5615e-01, -6.6162e-01, -7.2461e-01,  ..., -7.2815e-02,
           -9.9060e-02,  9.0210e-02],
          [-5.7764e-01, -7.4316e-01, -7.0215e-01,  ..., -1.1798e-01,
           -2.1704e-01,  1.1462e-01],
          [-5.7227e-01, -7.2119e-01, -6.9287e-01,  ..., -1.6138e-01,
           -2.1191e-01, -3.1555e-02]],
         [[-8.2825e-02, -4.8730e-01, -8.5693e-01,  ..., -1.1023e-01,
           -1.2164e-01, -1.1664e-01],
          [-3.3716e-01, -2.8760e-01, -2.2009e-01,  ..., -1.0712e-01,
           -1.3208e-01, -1.3110e-01],
          [ 8.6060e-03,  5.3589e-02,  1.1768e-01,  ..., -1.2756e-01,
           -1.3989e-01, -1.1267e-01],
          ...,
          [ 7.8003e-02,  3.0151e-02,  6.3232e-02,  ...,  5.5664e-01,
            4.7070e-01,  5.4883e-01],
          [ 5.3711e-02,  7.0801e-03,  1.2500e-01,  ...,  5.4248e-01,
            5.8594e-01,  5.5566e-01],
          [ 5.4565e-02,  3.4546e-02,  2.1228e-01,  ...,  6.8164e-01,
            6.4844e-01,  6.0938e-01]]],
        [[[-2.5464e-01,  1.4648e-01, -4.9683e-02,  ...,  1.1957e-01,
            1.2128e-01,  1.0309e-01],
          [-2.5024e-01,  1.3745e-01, -4.1626e-02,  ...,  1.1957e-01,
            9.8450e-02, -5.4932e-04],
          [-2.4072e-01,  1.5771e-01, -3.1677e-02,  ...,  1.0028e-01,
            1.6870e-01,  8.2703e-02],
          ...,
          [-2.6855e-01,  2.6794e-02, -2.0691e-01,  ..., -9.2969e-01,
           -6.7480e-01, -6.9043e-01],
          [-2.7173e-01,  2.7283e-02, -2.1826e-01,  ..., -5.4883e-01,
           -3.9209e-01, -7.1289e-01],
          [-2.6514e-01,  4.6448e-02, -2.2412e-01,  ..., -5.2832e-01,
           -3.7671e-01, -5.8154e-01]],
         [[-4.8975e-01, -7.9736e-01, -9.0576e-01,  ..., -7.9285e-02,
           -1.4819e-01, -8.9050e-02],
          [-4.8291e-01, -8.1104e-01, -9.0527e-01,  ..., -1.5088e-01,
           -1.8286e-01, -1.7017e-01],
          [-4.8242e-01, -8.0176e-01, -9.2773e-01,  ..., -1.3281e-01,
           -1.5576e-01, -1.8896e-01],
          ...,
          [-4.4629e-01, -6.9385e-01, -6.2891e-01,  ..., -2.7783e-01,
           -2.6917e-02, -5.5847e-02],
          [-4.3750e-01, -7.0654e-01, -6.0205e-01,  ..., -1.7822e-01,
            3.2532e-02, -1.7236e-01],
          [-4.3848e-01, -7.2168e-01, -6.6943e-01,  ..., -2.4463e-01,
           -2.6147e-01, -1.9995e-01]],
         [[ 1.3428e-01,  3.5986e-01,  3.0420e-01,  ...,  4.5361e-01,
            4.8535e-01,  4.5996e-01],
          [ 1.3025e-01,  3.6768e-01,  2.9688e-01,  ...,  3.8574e-01,
            3.9551e-01,  4.0088e-01],
          [ 1.2573e-01,  3.5693e-01,  3.0664e-01,  ...,  3.2764e-01,
            3.0225e-01,  3.2080e-01],
          ...,
          [ 8.9478e-02,  2.3987e-01,  2.0374e-01,  ...,  1.1191e+00,
            9.2773e-01,  7.9785e-01],
          [ 9.8389e-02,  2.8320e-01,  2.4036e-01,  ...,  1.0850e+00,
            6.6699e-01,  3.6816e-01],
          [ 8.3130e-02,  3.0713e-01,  2.8809e-01,  ...,  8.3301e-01,
            6.8604e-01,  4.0479e-01]]],
        [[[-1.3708e-01, -4.5135e-02,  1.6602e-02,  ..., -4.0063e-01,
           -3.9746e-01, -3.9844e-01],
          [ 1.9678e-01,  1.6919e-01,  1.2671e-01,  ..., -3.9673e-01,
           -3.9429e-01, -3.9746e-01],
          [-2.8931e-01, -3.1128e-01, -4.1675e-01,  ..., -3.9233e-01,
           -3.9136e-01, -3.9673e-01],
          ...,
          [-5.3662e-01, -5.4443e-01, -6.4502e-01,  ..., -1.2100e+00,
           -1.2334e+00, -9.5117e-01],
          [-5.2979e-01, -5.6836e-01, -6.6064e-01,  ..., -4.3848e-01,
           -5.6885e-01, -3.0908e-01],
          [-5.8057e-01, -5.2344e-01, -5.5127e-01,  ..., -2.1582e-01,
           -6.3110e-02, -4.0894e-01]],
         [[-1.1377e+00, -1.0918e+00, -1.0430e+00,  ..., -6.1572e-01,
           -6.1182e-01, -6.1084e-01],
          [-2.7075e-01, -2.6562e-01, -1.9604e-01,  ..., -6.1475e-01,
           -6.0986e-01, -6.0986e-01],
          [-1.3965e-01, -1.0516e-01, -8.4900e-02,  ..., -6.1084e-01,
           -6.0938e-01, -6.0986e-01],
          ...,
          [-6.0547e-01, -6.2744e-01, -5.3809e-01,  ..., -1.3867e+00,
           -9.2676e-01, -1.6074e+00],
          [-5.8838e-01, -5.9717e-01, -4.3066e-01,  ..., -1.3721e+00,
           -9.5801e-01, -1.0332e+00],
          [-5.8594e-01, -6.1084e-01, -3.3740e-01,  ..., -8.9355e-01,
           -9.0723e-01, -8.9893e-01]],
         [[ 3.0029e-01,  2.2644e-01,  3.8135e-01,  ...,  5.7129e-02,
            5.5176e-02,  5.5420e-02],
          [-4.3604e-01, -3.8818e-01, -3.8623e-01,  ...,  5.6885e-02,
            5.5176e-02,  5.5176e-02],
          [ 2.5439e-01,  2.8369e-01,  2.7637e-01,  ...,  5.5908e-02,
            5.4443e-02,  5.4565e-02],
          ...,
          [-7.4951e-02,  1.3135e-01,  1.8201e-01,  ...,  6.5332e-01,
            3.9404e-01,  5.1025e-01],
          [-5.8838e-02,  1.7664e-01,  2.1252e-01,  ...,  1.2610e-01,
            4.4287e-01,  4.6143e-01],
          [-3.9185e-02,  1.8372e-01,  1.8298e-01,  ...,  1.0083e-01,
           -1.0681e-01, -5.0140e-02]]],
        ...,
        [[[-1.7627e-01, -2.0728e-01,  8.2581e-02,  ...,  2.7856e-01,
           -5.3174e-01, -1.0137e+00],
          [-8.9795e-01, -7.8516e-01, -6.7725e-01,  ...,  1.7456e-01,
           -5.6934e-01, -1.0166e+00],
          [-3.8135e-01, -3.6548e-01, -3.6816e-01,  ..., -8.9172e-02,
           -4.2334e-01, -1.3457e+00],
          ...,
          [-3.0884e-01, -2.2339e-01, -2.7905e-01,  ..., -3.8281e-01,
           -3.4570e-01, -3.2178e-01],
          [-3.2861e-01, -3.1616e-01, -3.2935e-01,  ..., -3.7402e-01,
           -3.6841e-01, -3.4229e-01],
          [-3.1152e-01, -4.1699e-01, -3.8354e-01,  ..., -3.9307e-01,
           -4.5020e-01, -4.6460e-01]],
         [[-7.7588e-01, -7.8369e-01, -4.9707e-01,  ..., -1.9707e+00,
           -2.8516e+00, -2.2441e+00],
          [-8.4180e-01, -8.1543e-01, -7.5293e-01,  ..., -1.9863e+00,
           -2.9336e+00, -2.3086e+00],
          [-8.0518e-01, -7.8564e-01, -7.1094e-01,  ..., -1.8584e+00,
           -3.2344e+00, -2.2969e+00],
          ...,
          [-7.1240e-01, -6.9873e-01, -7.1924e-01,  ..., -6.3184e-01,
           -5.9814e-01, -5.6592e-01],
          [-7.2852e-01, -7.3877e-01, -7.3096e-01,  ..., -6.4209e-01,
           -6.3623e-01, -6.1670e-01],
          [-7.0459e-01, -7.2607e-01, -7.0459e-01,  ..., -6.8506e-01,
           -6.9531e-01, -7.2656e-01]],
         [[-7.8809e-01, -6.9727e-01, -8.4766e-01,  ..., -1.0283e+00,
            2.9785e-01,  6.9531e-01],
          [-1.6943e-01, -2.5415e-01, -3.2446e-01,  ..., -9.3701e-01,
            2.8174e-01,  7.4756e-01],
          [-9.6741e-02, -9.0454e-02, -2.9968e-02,  ..., -9.7119e-01,
            4.4580e-01,  9.3164e-01],
          ...,
          [-2.3645e-01, -2.5537e-01, -2.7637e-01,  ..., -4.0619e-02,
           -7.6721e-02, -6.3477e-02],
          [-2.1191e-01, -2.0471e-01, -2.2363e-01,  ..., -6.0120e-02,
           -5.3894e-02, -2.7100e-02],
          [-2.9297e-01, -2.4829e-01, -2.1436e-01,  ..., -8.3069e-02,
           -7.9346e-02, -4.2023e-02]]],
        [[[-1.4673e-01, -1.8750e-01, -1.7395e-01,  ..., -8.6060e-02,
           -8.2886e-02, -1.0571e-01],
          [ 7.0618e-02,  4.1504e-03,  1.2085e-02,  ..., -1.1566e-01,
           -7.6172e-02, -8.2703e-02],
          [ 2.5635e-03, -2.0752e-02, -4.6753e-02,  ..., -1.0101e-01,
           -3.5706e-02, -4.8035e-02],
          ...,
          [-3.6523e-01, -3.2593e-01, -3.2471e-01,  ...,  2.8809e-01,
            2.0825e-01,  6.4636e-02],
          [-3.8501e-01, -3.4985e-01, -3.4619e-01,  ...,  2.6929e-01,
            2.1021e-01,  1.2817e-02],
          [-3.8599e-01, -3.6304e-01, -3.3862e-01,  ...,  2.3633e-01,
            2.0020e-01, -3.3417e-02]],
         [[ 6.6528e-02,  7.0801e-03, -2.1240e-02,  ..., -2.1460e-01,
           -1.9189e-01, -1.9019e-01],
          [ 6.6528e-02,  5.7983e-03, -9.3384e-03,  ..., -2.0923e-01,
           -1.9067e-01, -1.9312e-01],
          [-1.6968e-02, -3.9429e-02, -3.9612e-02,  ..., -1.6431e-01,
           -1.7456e-01, -1.7358e-01],
          ...,
          [-4.3848e-01, -3.9990e-01, -3.9380e-01,  ...,  2.9492e-01,
            1.9702e-01,  1.2964e-01],
          [-4.1943e-01, -3.9771e-01, -4.0771e-01,  ...,  3.1323e-01,
            1.9897e-01,  1.0950e-01],
          [-4.0918e-01, -3.8672e-01, -3.9697e-01,  ...,  3.0762e-01,
            1.8799e-01,  1.1584e-01]],
         [[ 4.2920e-01,  4.1650e-01,  4.0088e-01,  ...,  3.4912e-01,
            3.9795e-01,  3.9990e-01],
          [ 1.9421e-01,  2.1741e-01,  2.2058e-01,  ...,  3.1934e-01,
            3.3252e-01,  3.7500e-01],
          [ 2.2693e-01,  2.5293e-01,  2.3865e-01,  ...,  3.2471e-01,
            3.5547e-01,  3.7744e-01],
          ...,
          [ 3.6865e-02, -2.7527e-02, -8.8501e-03,  ...,  4.3652e-01,
            5.2002e-01,  4.0967e-01],
          [ 2.5879e-02, -1.7700e-02, -2.7100e-02,  ...,  3.7744e-01,
            5.3564e-01,  4.3164e-01],
          [ 3.6377e-02, -3.0518e-02, -1.0559e-02,  ...,  3.4961e-01,
            5.2490e-01,  4.8877e-01]]],
        [[[ 8.2092e-02,  1.8799e-01,  1.9434e-01,  ..., -3.2642e-01,
           -2.8613e-01, -2.7075e-01],
          [ 9.2590e-02,  1.9482e-01,  1.8091e-01,  ..., -3.1226e-01,
           -2.5781e-01, -2.8027e-01],
          [ 6.1951e-02,  1.6406e-01,  1.9849e-01,  ..., -2.9492e-01,
           -2.7588e-01, -2.6611e-01],
          ...,
          [-3.9722e-01, -3.9575e-01, -3.9746e-01,  ..., -4.2749e-01,
           -4.0820e-01, -3.6694e-01],
          [-3.8037e-01, -3.8574e-01, -3.8501e-01,  ..., -4.3848e-01,
           -4.2969e-01, -4.0771e-01],
          [-3.6938e-01, -3.7793e-01, -3.8965e-01,  ..., -4.1333e-01,
           -4.1577e-01, -4.1138e-01]],
         [[-3.5889e-02, -1.3110e-01, -8.7952e-02,  ..., -5.3857e-01,
           -5.3369e-01, -5.3613e-01],
          [-2.8320e-02, -8.9050e-02, -7.4280e-02,  ..., -5.4004e-01,
           -5.4053e-01, -5.2539e-01],
          [-1.9409e-02, -9.9548e-02, -3.2593e-02,  ..., -5.6396e-01,
           -5.6152e-01, -5.1953e-01],
          ...,
          [-5.9814e-01, -5.8350e-01, -5.4688e-01,  ..., -5.5176e-01,
           -5.5273e-01, -5.5518e-01],
          [-6.2305e-01, -5.5176e-01, -5.4297e-01,  ..., -5.6787e-01,
           -5.5859e-01, -5.7031e-01],
          [-6.1230e-01, -5.2490e-01, -5.3857e-01,  ..., -5.6055e-01,
           -5.6299e-01, -5.8008e-01]],
         [[-2.3132e-02, -2.8992e-02,  2.0081e-02,  ...,  1.0742e-02,
           -2.1912e-02, -3.4119e-02],
          [-1.1597e-02,  1.4893e-02,  6.3843e-02,  ...,  8.4229e-03,
           -8.7891e-03, -4.1809e-02],
          [-1.3428e-02,  4.9561e-02,  3.1860e-02,  ...,  6.1035e-04,
           -5.7983e-03, -2.9846e-02],
          ...,
          [ 3.9673e-02,  6.1523e-02,  4.2847e-02,  ...,  2.3010e-02,
            1.2024e-02,  1.2329e-02],
          [ 4.7729e-02,  5.3467e-02,  5.2734e-02,  ...,  4.4434e-02,
            3.5889e-02,  3.9185e-02],
          [ 5.9082e-02,  7.0923e-02,  5.5420e-02,  ...,  3.4302e-02,
            4.3579e-02,  3.7964e-02]]]], device='cuda:0', dtype=torch.float16,
       grad_fn=<ConvolutionBackward0>)
torch.Size([100, 3, 192, 192])
Epoch 1/50:   0%|          | 0/2049 [01:44<?, ?img/s]
Traceback (most recent call last):
  File "C:\Users\mdini\Desktop\CVDL\LFW-Segmentation\LFW-Segmentation-With-UNet\train.py", line 140, in <module>
    train_model()
  File "C:\Users\mdini\Desktop\CVDL\LFW-Segmentation\LFW-Segmentation-With-UNet\train.py", line 76, in train_model
    loss = criterion(masks_pred.view(-1,1), true_masks)
                     ^^^^^^^^^^^^^^^^^^^^^
RuntimeError: view size is not compatible with input tensor's size and stride (at least one dimension spans across two contiguous subspaces). Use .reshape(...) instead.