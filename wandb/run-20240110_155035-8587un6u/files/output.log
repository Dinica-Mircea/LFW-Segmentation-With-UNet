
Using device:  cuda
Epoch 1/50:   0%|          | 0/2049 [00:00<?, ?img/s]
torch.Size([100, 3, 200, 200])
torch.Size([100, 64, 196, 196])
torch.Size([100, 64, 98, 98])
torch.Size([100, 128, 94, 94])
torch.Size([100, 128, 47, 47])
torch.Size([100, 256, 43, 43])
torch.Size([100, 256, 21, 21])
torch.Size([100, 512, 17, 17])
torch.Size([100, 512, 8, 8])
tensor([[[[ 2.1680e-01,  2.2241e-01,  3.1372e-01,  ...,  3.7646e-01,
            1.0046e-01,  6.4880e-02],
          [ 3.6865e-01,  5.3467e-01,  4.9707e-01,  ...,  1.7529e-01,
            4.4580e-01,  2.1667e-01],
          [ 6.2988e-01,  6.0791e-01,  9.0771e-01,  ...,  8.2471e-01,
            4.7412e-01,  2.8345e-01],
          ...,
          [ 4.7363e-01,  4.0234e-01,  5.0781e-01,  ...,  1.9861e-01,
            1.6846e-01,  1.8054e-01],
          [ 4.3164e-01,  3.6621e-01,  4.8682e-01,  ...,  1.5710e-01,
            1.4526e-01,  1.7798e-01],
          [ 3.5547e-01,  3.1958e-01,  4.8486e-01,  ...,  1.7432e-01,
            1.8042e-01,  1.8872e-01]],
         [[-6.5063e-02, -2.1021e-01,  3.0518e-04,  ..., -2.1912e-01,
           -5.6543e-01, -7.4561e-01],
          [-1.2170e-01,  2.3041e-02, -1.0315e-02,  ..., -4.3433e-01,
           -6.5918e-01, -5.4688e-01],
          [ 1.4893e-01,  1.0834e-02,  8.4595e-02,  ..., -4.5752e-01,
           -6.2158e-01, -3.6841e-01],
          ...,
          [-9.7351e-02, -1.7224e-01, -1.1536e-01,  ..., -1.6809e-01,
           -1.5466e-01, -1.5198e-01],
          [-1.4734e-01, -1.9238e-01, -1.5381e-01,  ..., -1.8506e-01,
           -1.8347e-01, -1.6187e-01],
          [-2.9639e-01, -2.9810e-01, -1.8042e-01,  ..., -1.7493e-01,
           -1.8188e-01, -1.8567e-01]],
         [[-1.9714e-01, -1.3208e-01, -1.1121e-01,  ...,  5.3650e-02,
            7.5989e-02,  3.1104e-01],
          [-2.3047e-01, -2.7271e-01, -3.0737e-01,  ..., -2.9395e-01,
            2.9358e-02,  1.5552e-01],
          [-1.4062e-01, -2.3828e-01, -2.6294e-01,  ..., -1.6968e-02,
           -7.5256e-02, -4.1211e-01],
          ...,
          [ 1.7285e-01,  1.2103e-01,  1.1688e-01,  ..., -2.1802e-01,
           -2.0117e-01, -2.1729e-01],
          [ 1.8018e-01,  1.0370e-01,  1.0822e-01,  ..., -2.1619e-01,
           -1.9922e-01, -2.0825e-01],
          [ 1.3818e-01,  1.4917e-01,  1.4478e-01,  ..., -2.1802e-01,
           -2.0288e-01, -2.1729e-01]]],
        [[[ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.1113e-01,
            4.0918e-01,  4.1602e-01],
          [ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.1650e-01,
            4.2139e-01,  4.1992e-01],
          [ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.2432e-01,
            4.1992e-01,  4.1895e-01],
          ...,
          [ 4.8340e-01,  4.5605e-01,  4.0430e-01,  ...,  6.4551e-01,
            6.4502e-01,  6.8164e-01],
          [ 4.7021e-01,  4.4971e-01,  3.9941e-01,  ...,  6.2598e-01,
            6.8896e-01,  6.8799e-01],
          [ 4.8633e-01,  4.5947e-01,  4.3164e-01,  ...,  4.9414e-01,
            6.8945e-01,  7.0361e-01]],
         [[-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.1470e-01,
           -3.2178e-01, -3.1958e-01],
          [-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.1592e-01,
           -3.1519e-01, -3.1299e-01],
          [-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.0786e-01,
           -3.1104e-01, -3.1055e-01],
          ...,
          [-1.4783e-01, -1.6772e-01, -2.3376e-01,  ..., -1.4819e-01,
           -1.2915e-01, -1.0083e-01],
          [-1.6663e-01, -1.7249e-01, -2.4597e-01,  ..., -1.6211e-01,
           -1.5356e-01, -1.3855e-01],
          [-1.5637e-01, -1.8359e-01, -2.4084e-01,  ..., -1.7664e-01,
           -1.6931e-01, -1.4893e-01]],
         [[-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -1.1151e-01,
           -1.1249e-01, -1.0986e-01],
          [-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -1.0925e-01,
           -1.1755e-01, -1.1316e-01],
          [-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -1.1682e-01,
           -1.2061e-01, -1.1133e-01],
          ...,
          [-5.7434e-02, -1.2573e-01, -1.1334e-01,  ...,  1.0992e-01,
            2.6611e-02, -4.3762e-02],
          [-6.9824e-02, -1.1957e-01, -1.1810e-01,  ...,  1.2164e-01,
            4.9011e-02, -2.0142e-03],
          [-5.5786e-02, -1.2280e-01, -1.2073e-01,  ...,  9.4788e-02,
            5.7678e-02,  3.8757e-02]]],
        [[[ 1.7344e+00,  1.8428e+00,  1.7666e+00,  ...,  2.7266e+00,
            2.2988e+00,  2.7188e+00],
          [ 1.2783e+00,  1.3213e+00,  1.3760e+00,  ...,  1.9346e+00,
            1.8086e+00,  2.0898e+00],
          [ 8.4766e-01,  1.0645e+00,  1.0303e+00,  ...,  1.2959e+00,
            8.8232e-01,  1.3291e+00],
          ...,
          [ 1.2393e+00,  1.8105e+00,  2.2031e+00,  ...,  1.8105e+00,
            1.5840e+00,  1.4658e+00],
          [ 1.2871e+00,  1.7881e+00,  2.2324e+00,  ...,  1.6982e+00,
            1.5166e+00,  1.4805e+00],
          [ 1.2754e+00,  1.7764e+00,  2.2305e+00,  ...,  1.5918e+00,
            1.5176e+00,  1.4980e+00]],
         [[ 1.0791e-01,  4.8877e-01,  5.4492e-01,  ...,  5.3467e-01,
            2.2803e-01,  1.7517e-01],
          [-5.2051e-01, -3.4229e-01, -1.9629e-01,  ...,  2.0898e-01,
            5.0684e-01,  3.1421e-01],
          [-4.1504e-01,  3.6469e-02, -8.7769e-02,  ...,  6.0742e-01,
            3.5498e-01,  4.9023e-01],
          ...,
          [ 2.1704e-01,  5.6738e-01,  8.6230e-01,  ...,  7.5732e-01,
            6.8604e-01,  5.2930e-01],
          [ 2.0117e-01,  5.2930e-01,  8.3691e-01,  ...,  6.7432e-01,
            6.2891e-01,  5.1465e-01],
          [ 1.7651e-01,  4.5264e-01,  7.9639e-01,  ...,  6.2842e-01,
            6.0205e-01,  5.1367e-01]],
         [[-7.3877e-01, -1.3252e+00, -1.4854e+00,  ..., -2.8398e+00,
           -2.4863e+00, -2.5645e+00],
          [-1.5796e-01, -7.9443e-01, -7.8809e-01,  ..., -3.5547e-01,
           -4.9414e-01,  4.5349e-02],
          [ 2.1484e-01, -4.0210e-01, -5.1611e-01,  ..., -2.2461e-01,
           -3.8306e-01, -6.2988e-01],
          ...,
          [ 5.0537e-01, -6.1493e-02,  4.7791e-02,  ...,  8.6487e-02,
            7.3792e-02,  1.5186e-01],
          [ 5.2441e-01,  7.3242e-04,  9.7961e-02,  ...,  1.1151e-01,
            6.1951e-02,  1.3623e-01],
          [ 5.4736e-01, -1.0010e-02,  9.4055e-02,  ...,  8.8074e-02,
            1.6846e-02,  9.0393e-02]]],
        ...,
        [[[ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.1797e-01,
            4.1797e-01,  4.1797e-01],
          [ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.1797e-01,
            4.1797e-01,  4.1797e-01],
          [ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.1797e-01,
            4.1797e-01,  4.1797e-01],
          ...,
          [ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.0625e-01,
            4.1504e-01,  4.1748e-01],
          [ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.1309e-01,
            4.1602e-01,  4.1895e-01],
          [ 4.1797e-01,  4.1797e-01,  4.1797e-01,  ...,  4.2773e-01,
            4.1699e-01,  4.1797e-01]],
         [[-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.1567e-01,
           -3.1567e-01, -3.1567e-01],
          [-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.1567e-01,
           -3.1567e-01, -3.1567e-01],
          [-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.1567e-01,
           -3.1567e-01, -3.1567e-01],
          ...,
          [-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.1787e-01,
           -3.2446e-01, -3.2007e-01],
          [-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.2300e-01,
           -3.2104e-01, -3.1396e-01],
          [-3.1567e-01, -3.1567e-01, -3.1567e-01,  ..., -3.1689e-01,
           -3.1641e-01, -3.1348e-01]],
         [[-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -1.0834e-01,
           -1.0834e-01, -1.0834e-01],
          [-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -1.0834e-01,
           -1.0834e-01, -1.0834e-01],
          [-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -1.0834e-01,
           -1.0834e-01, -1.0834e-01],
          ...,
          [-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -9.7900e-02,
           -1.1359e-01, -1.1127e-01],
          [-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -1.0681e-01,
           -1.1005e-01, -1.0968e-01],
          [-1.0834e-01, -1.0834e-01, -1.0834e-01,  ..., -1.1658e-01,
           -1.1768e-01, -1.0876e-01]]],
        [[[ 4.0967e-01,  3.9697e-01,  3.9062e-01,  ...,  3.0029e-01,
            3.2178e-01,  3.3936e-01],
          [ 3.9600e-01,  3.8867e-01,  3.9355e-01,  ...,  3.1592e-01,
            3.2129e-01,  3.3374e-01],
          [ 3.7061e-01,  3.7256e-01,  3.8818e-01,  ...,  3.1226e-01,
            3.1665e-01,  3.4033e-01],
          ...,
          [ 3.2715e-01,  3.4863e-01,  3.4937e-01,  ...,  2.6514e-01,
            2.6416e-01,  2.8027e-01],
          [ 3.1152e-01,  3.2520e-01,  3.2080e-01,  ...,  2.6221e-01,
            2.7295e-01,  2.8613e-01],
          [ 2.9199e-01,  2.9785e-01,  2.9199e-01,  ...,  2.5732e-01,
            2.6318e-01,  2.8247e-01]],
         [[-2.2656e-01, -2.3389e-01, -2.2571e-01,  ..., -2.5659e-01,
           -2.6611e-01, -2.8564e-01],
          [-2.2144e-01, -2.2961e-01, -2.2681e-01,  ..., -2.5415e-01,
           -2.6294e-01, -2.8687e-01],
          [-2.6147e-01, -2.5830e-01, -2.5244e-01,  ..., -2.6880e-01,
           -2.6074e-01, -2.7563e-01],
          ...,
          [-2.6270e-01, -2.7344e-01, -2.5806e-01,  ..., -2.7026e-01,
           -2.6465e-01, -2.6807e-01],
          [-2.8735e-01, -2.8101e-01, -2.7856e-01,  ..., -2.7905e-01,
           -2.7295e-01, -2.7075e-01],
          [-2.8174e-01, -2.8638e-01, -2.8955e-01,  ..., -2.7490e-01,
           -2.5928e-01, -2.5317e-01]],
         [[-4.0015e-01, -4.1089e-01, -4.0063e-01,  ..., -2.1643e-01,
           -2.2705e-01, -2.3071e-01],
          [-3.9111e-01, -3.9087e-01, -3.9111e-01,  ..., -2.1033e-01,
           -2.3340e-01, -2.2852e-01],
          [-3.9111e-01, -3.8745e-01, -3.8647e-01,  ..., -2.2681e-01,
           -2.2827e-01, -2.2363e-01],
          ...,
          [-1.8994e-01, -2.0117e-01, -2.1533e-01,  ..., -1.9995e-01,
           -2.0044e-01, -2.1216e-01],
          [-1.8677e-01, -2.0410e-01, -2.0178e-01,  ..., -2.0081e-01,
           -2.0813e-01, -2.1289e-01],
          [-2.0703e-01, -1.9092e-01, -2.0996e-01,  ..., -2.1985e-01,
           -2.2559e-01, -2.2534e-01]]],
        [[[ 5.7275e-01,  5.8301e-01,  5.5566e-01,  ...,  3.9258e-01,
            5.6689e-01, -5.7007e-02],
          [ 5.6787e-01,  5.6055e-01,  5.7910e-01,  ...,  4.2529e-01,
            5.6543e-01, -5.9326e-02],
          [ 5.6445e-01,  5.6201e-01,  5.5811e-01,  ...,  4.3164e-01,
            5.4492e-01, -4.3823e-02],
          ...,
          [ 3.5400e-01,  3.9551e-01,  4.5605e-01,  ...,  5.9961e-01,
            8.9014e-01,  9.7021e-01],
          [ 3.4961e-01,  3.9453e-01,  4.4629e-01,  ...,  7.0264e-01,
            9.0186e-01,  9.2676e-01],
          [ 3.4863e-01,  3.8965e-01,  4.4092e-01,  ...,  6.3721e-01,
            9.7705e-01,  9.9609e-01]],
         [[-3.5309e-02, -3.1372e-02, -4.4281e-02,  ..., -6.4893e-01,
            2.0947e-01,  2.8223e-01],
          [-3.9490e-02, -3.3936e-02, -2.3407e-02,  ..., -6.2207e-01,
            2.1118e-01,  2.6660e-01],
          [-4.5868e-02, -3.9917e-02, -5.4016e-02,  ..., -6.3965e-01,
            1.9336e-01,  2.7393e-01],
          ...,
          [-2.3438e-01, -2.6196e-01, -2.5122e-01,  ..., -2.1582e-01,
           -6.2378e-02, -4.4507e-01],
          [-2.6367e-01, -2.4951e-01, -2.3596e-01,  ..., -1.6736e-01,
           -8.8257e-02, -4.4604e-01],
          [-2.6929e-01, -2.5806e-01, -2.3071e-01,  ..., -1.6980e-01,
           -8.5632e-02, -4.4482e-01]],
         [[-1.6907e-01, -1.5796e-01, -1.6284e-01,  ..., -1.8958e-01,
           -4.0698e-01,  1.7871e-01],
          [-1.5381e-01, -1.5540e-01, -1.7285e-01,  ..., -1.9275e-01,
           -4.2188e-01,  1.9092e-01],
          [-1.6113e-01, -1.6260e-01, -1.5100e-01,  ..., -1.7456e-01,
           -4.2944e-01,  1.9385e-01],
          ...,
          [-8.2581e-02, -8.4045e-02, -9.2896e-02,  ...,  2.8076e-02,
           -2.3901e-01, -9.6191e-02],
          [-7.8491e-02, -8.0627e-02, -9.0454e-02,  ...,  8.7891e-03,
           -2.2510e-01, -1.2451e-01],
          [-8.9539e-02, -8.3984e-02, -7.3914e-02,  ..., -3.1555e-02,
           -1.7029e-01, -1.5015e-01]]]], device='cuda:0', dtype=torch.float16,
       grad_fn=<ConvolutionBackward0>)
torch.Size([100, 3, 192, 192])
Epoch 1/50:   0%|          | 0/2049 [01:44<?, ?img/s]
Traceback (most recent call last):
  File "C:\Users\mdini\Desktop\CVDL\LFW-Segmentation\LFW-Segmentation-With-UNet\train.py", line 140, in <module>
    except torch.cuda.OutOfMemoryError:
        ^^^^^^^^^^^^^
  File "C:\Users\mdini\Desktop\CVDL\LFW-Segmentation\LFW-Segmentation-With-UNet\train.py", line 76, in train_model
    loss += dice_loss(
           ^^^^^^^^^^^^
  File "C:\Users\mdini\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mdini\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mdini\anaconda3\Lib\site-packages\torch\nn\modules\loss.py", line 1179, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mdini\anaconda3\Lib\site-packages\torch\nn\functional.py", line 3053, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: only batches of spatial targets supported (3D tensors) but got targets of size: : [100, 3, 200, 200]